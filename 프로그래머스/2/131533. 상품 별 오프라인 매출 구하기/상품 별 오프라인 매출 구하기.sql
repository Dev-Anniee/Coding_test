SELECT PRODUCT_CODE, SUM(SALES_AMOUNT* P.PRICE) AS SALES
FROM OFFLINE_SALE O
JOIN PRODUCT P
USING (PRODUCT_ID)
GROUP BY PRODUCT_CODE, PRODUCT_ID, P.PRICE
ORDER BY SALES desc, PRODUCT_CODE;